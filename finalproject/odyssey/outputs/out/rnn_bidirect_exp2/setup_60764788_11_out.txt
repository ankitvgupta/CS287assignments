[?1034hUsing cuda	
datafile:	/n/home09/ankitgupta/CS287/CS287assignments/finalproject/PRINC_CB513_1.hdf5	classifier:	rnn	b:	128	alpha:	1	sequence_length:	100	embedding_size	500	optimizer:	sgd	epochs:	600	hidden	200	eta:	0.01	rnn_unit1	lstm	rnn_unit2	lstm	dropout	0.5	
Num classes:	10	
Vocab size:	37	
Start class:	1	
Test size	     1
 83300
[torch.LongStorage of size 2]

Using cuda	
 1183318
       1
[torch.LongStorage of size 2]

  128
 9244
[torch.LongStorage of size 2]

  128
 9244
[torch.LongStorage of size 2]

Converted LSTM to CUDA	
Converted crit to CUDA	
nn.Sequential {
  [input -> (1) -> (2) -> (3) -> (4) -> (5) -> (6) -> (7) -> (8) -> (9) -> (10) -> output]
  (1): nn.LookupTable
  (2): nn.Transpose
  (3): nn.SplitTable
  (4): nn.BiSequencer @ nn.Sequential {
    [input -> (1) -> (2) -> (3) -> output]
    (1): nn.ConcatTable {
      input
        |`-> (1): nn.Sequencer @ nn.FastLSTM(500 -> 500)
        |`-> (2): nn.Sequential {
        |      [input -> (1) -> (2) -> (3) -> output]
        |      (1): nn.ReverseTable
        |      (2): nn.Sequencer @ nn.FastLSTM(500 -> 500)
        |      (3): nn.ReverseTable
        |    }
         ... -> output
    }
    (2): nn.ZipTable
    (3): nn.Sequencer @ nn.Recursor @ nn.JoinTable
  }
  (5): nn.Sequencer @ nn.Recursor @ nn.Dropout(0.5, busy)
  (6): nn.Sequencer @ nn.Recursor @ nn.Linear(1000 -> 200)
  (7): nn.Sequencer @ nn.Recursor @ nn.ReLU
  (8): nn.Sequencer @ nn.Recursor @ nn.Dropout(0.5, busy)
  (9): nn.Sequencer @ nn.Recursor @ nn.Linear(200 -> 10)
  (10): nn.Sequencer @ nn.Recursor @ nn.LogSoftMax
}
Input size	9244	
Max train index	23	
Num samples	9244	
Epoch	1	230.18314051628	
Epoch	2	150.3368588686	
Epoch	3	144.08324408531	
Epoch	4	141.57115983963	
Epoch	5	140.14825332165	
Epoch	6	139.23678290844	
Epoch	7	138.5224134922	
Epoch	8	137.66341614723	
Epoch	9	137.21555280685	
Epoch	10	136.74718427658	
Epoch	11	135.79612195492	
Epoch	12	135.23244953156	
Epoch	13	135.25022029877	
Epoch	14	134.66642308235	
Epoch	15	134.18583226204	
Epoch	16	133.83630979061	
Epoch	17	133.59186697006	
Epoch	18	133.22953259945	
Epoch	19	133.1912933588	
Epoch	20	132.70166766644	
Epoch	21	132.61211907864	
Epoch	22	132.41688072681	
Epoch	23	132.07646000385	
Epoch	24	131.78435099125	
Epoch	25	131.49345910549	
Epoch	26	131.69260907173	
Epoch	27	130.9968034029	
Epoch	28	131.08310711384	
Epoch	29	130.86788272858	
Epoch	30	130.83500730991	
Epoch	31	130.72070646286	
Epoch	32	130.77681219578	
Epoch	33	130.54228413105	
Epoch	34	130.46127068996	
Epoch	35	130.16713297367	
Epoch	36	129.95265364647	
Epoch	37	129.88758182526	
Epoch	38	129.54527306557	
Epoch	39	129.50625479221	
Epoch	40	129.71662414074	
Epoch	41	129.77482867241	
Epoch	42	129.53575468063	
Epoch	43	129.30862689018	
Epoch	44	129.25832104683	
Epoch	45	128.73552298546	
Epoch	46	128.89446634054	
Epoch	47	128.96930134296	
Epoch	48	128.79069340229	
Epoch	49	128.79364871979	
Epoch	50	128.3729288578	
Epoch	51	128.50970697403	
Epoch	52	128.05862224102	
Epoch	53	128.67528164387	
Epoch	54	128.66302502155	
Epoch	55	128.22158932686	
Epoch	56	128.41097581387	
Epoch	57	128.14347863197	
Epoch	58	128.13581854105	
Epoch	59	127.906930089	
Epoch	60	128.32069420815	
Epoch	61	127.79159712791	
Epoch	62	127.54361087084	
Epoch	63	127.23235881329	
Epoch	64	127.35140955448	
Epoch	65	127.2270860672	
Epoch	66	127.51457732916	
Epoch	67	127.52370393276	
Epoch	68	127.27216041088	
Epoch	69	127.28047215939	
Epoch	70	126.46682810783	
Epoch	71	126.27593076229	
Epoch	72	126.39876103401	
Epoch	73	127.00754004717	
Epoch	74	126.44971561432	
Epoch	75	126.22379541397	
Epoch	76	126.35928225517	
Epoch	77	126.61083745956	
Epoch	78	126.43061041832	
Epoch	79	126.29369264841	
Epoch	80	126.18001031876	
Epoch	81	125.75587189198	
Epoch	82	125.85506224632	
Epoch	83	125.60947597027	
Epoch	84	125.40705084801	
Epoch	85	125.11963117123	
Epoch	86	125.48033565283	
Epoch	87	125.10378140211	
Epoch	88	125.47916668653	
Epoch	89	124.88490217924	
Epoch	90	124.79253417253	
Epoch	91	125.32665240765	
Epoch	92	124.90544867516	
Epoch	93	124.95616543293	
Epoch	94	125.0250762105	
Epoch	95	124.60251408815	
Epoch	96	124.67891699076	
Epoch	97	124.99032860994	
Epoch	98	124.24489444494	
Epoch	99	124.05995553732	
Epoch	100	123.86157160997	
Epoch	101	123.60228025913	
Epoch	102	123.72497671843	
Epoch	103	124.08309459686	
Epoch	104	123.51411217451	
Epoch	105	123.40237778425	
Epoch	106	123.27798074484	
Epoch	107	123.68138360977	
Epoch	108	123.8879122138	
Epoch	109	123.79986602068	
Epoch	110	123.66684174538	
Epoch	111	123.9550588727	
Epoch	112	123.22731041908	
Epoch	113	122.9813978672	
Epoch	114	123.01999771595	
Epoch	115	123.0898399353	
Epoch	116	123.11919790506	
Epoch	117	123.06918698549	
Epoch	118	123.02675181627	
Epoch	119	123.13655370474	
Epoch	120	123.1308503747	
Epoch	121	122.97888582945	
Epoch	122	122.72162044048	
Epoch	123	122.85213857889	
Epoch	124	122.19975298643	
Epoch	125	122.76953005791	
Epoch	126	122.55476438999	
Epoch	127	122.16270232201	
Epoch	128	122.40731984377	
Epoch	129	122.11748301983	
Epoch	130	121.73250263929	
Epoch	131	121.93305963278	
Epoch	132	121.70974886417	
Epoch	133	122.6289576292	
Epoch	134	121.96590471268	
Epoch	135	121.82361376286	
Epoch	136	121.8081458807	
Epoch	137	121.78571039438	
Epoch	138	121.36260181665	
Epoch	139	121.32279706001	
Epoch	140	121.84766662121	
Epoch	141	121.37927061319	
Epoch	142	121.30530613661	
Epoch	143	121.13149118423	
Epoch	144	121.64648801088	
Epoch	145	121.33545690775	
Epoch	146	121.21977865696	
Epoch	147	121.31181865931	
Epoch	148	120.95860230923	
Epoch	149	121.31372588873	
Epoch	150	121.01928639412	
Epoch	151	121.39371776581	
Epoch	152	121.10116219521	
Epoch	153	121.02167892456	
Epoch	154	120.63629281521	
Epoch	155	121.31509584188	
Epoch	156	121.08581352234	
Epoch	157	120.80195909739	
Epoch	158	120.90478175879	
Epoch	159	120.6288972497	
Epoch	160	120.48923557997	
Epoch	161	120.85999727249	
Epoch	162	120.87182503939	
Epoch	163	120.73112785816	
Epoch	164	120.56495755911	
Epoch	165	120.34688192606	
Epoch	166	120.78346920013	
Epoch	167	120.18014496565	
Epoch	168	120.07293707132	
Epoch	169	120.53050631285	
Epoch	170	120.57605338097	
Epoch	171	120.24846827984	
Epoch	172	120.76463079453	
Epoch	173	120.19782280922	
Epoch	174	120.30921322107	
Epoch	175	120.46078962088	
Epoch	176	120.11559039354	
Epoch	177	120.11643791199	
Epoch	178	120.29366594553	
Epoch	179	120.12203919888	
Epoch	180	120.20685064793	
Epoch	181	119.28978538513	
Epoch	182	119.96893805265	
Epoch	183	119.91392070055	
Epoch	184	119.45076137781	
Epoch	185	119.88602209091	
Epoch	186	119.90358823538	
Epoch	187	119.52982139587	
Epoch	188	119.67978298664	
Epoch	189	119.21226865053	
Epoch	190	119.68992394209	
Epoch	191	119.79278355837	
Epoch	192	119.82980507612	
Epoch	193	119.34819960594	
Epoch	194	119.63247537613	
Epoch	195	119.69348961115	
Epoch	196	119.9155292511	
Epoch	197	119.4888125658	
Epoch	198	119.45823776722	
Epoch	199	119.36932945251	
Epoch	200	119.42531782389	
Epoch	201	119.2071583271	
Epoch	202	119.18070375919	
Epoch	203	118.98531913757	
Epoch	204	119.06618118286	
Epoch	205	118.67679780722	
Epoch	206	119.04568934441	
Epoch	207	119.03973287344	
Epoch	208	118.89977568388	
Epoch	209	118.83045268059	
Epoch	210	119.09917795658	
Epoch	211	119.16442626715	
Epoch	212	118.66918307543	
Epoch	213	118.68506985903	
Epoch	214	119.04446172714	
Epoch	215	118.62015116215	
Epoch	216	118.85015040636	
Epoch	217	118.98131722212	
Epoch	218	118.89225560427	
Epoch	219	118.84125685692	
Epoch	220	118.90402978659	
Epoch	221	118.80484223366	
Epoch	222	118.67366784811	
Epoch	223	118.01533764601	
Epoch	224	118.72665190697	
Epoch	225	118.30677253008	
Epoch	226	118.56460273266	
Epoch	227	118.32989519835	
Epoch	228	118.34855461121	
Epoch	229	118.44128531218	
Epoch	230	118.55505353212	
Epoch	231	118.15671271086	
Epoch	232	118.16475194693	
Epoch	233	117.99051839113	
Epoch	234	118.27553641796	
Epoch	235	118.1789804101	
Epoch	236	118.31434237957	
Epoch	237	118.15938675404	
Epoch	238	117.90176475048	
Epoch	239	117.67758446932	
Epoch	240	117.58794635534	
Epoch	241	117.59843927622	
Epoch	242	117.62316209078	
Epoch	243	117.48847579956	
Epoch	244	117.77249008417	
Epoch	245	118.25910913944	
Epoch	246	117.74849772453	
Epoch	247	117.82709127665	
Epoch	248	117.95259571075	
Epoch	249	117.69687443972	
Epoch	250	117.52621805668	
Epoch	251	117.93545526266	
Epoch	252	117.56268930435	
Epoch	253	117.30994856358	
Epoch	254	117.63182842731	
Epoch	255	117.30221444368	
Epoch	256	117.30616521835	
Epoch	257	117.90324884653	
Epoch	258	117.76255548	
Epoch	259	117.37528550625	
Epoch	260	117.2868193388	
Epoch	261	117.0746344924	
Epoch	262	117.31888663769	
Epoch	263	116.77212780714	
Epoch	264	117.15090477467	
Epoch	265	116.81918329	
Epoch	266	116.42899781466	
Epoch	267	116.66950827837	
Epoch	268	116.31296998262	
Epoch	269	117.21642303467	
Epoch	270	116.42450112104	
Epoch	271	116.27850270271	
Epoch	272	116.2847943902	
Epoch	273	116.39018940926	
Epoch	274	116.14053213596	
Epoch	275	117.06868851185	
Epoch	276	116.48599749804	
Epoch	277	116.37194228172	
Epoch	278	116.13451063633	
Epoch	279	116.13780742884	
Epoch	280	116.5326923728	
Epoch	281	116.61151951551	
Epoch	282	116.04371994734	
Epoch	283	115.98157387972	
Epoch	284	116.23426532745	
Epoch	285	115.88901120424	
Epoch	286	115.84809911251	
Epoch	287	115.46840173006	
Epoch	288	116.13865733147	
Epoch	289	115.4829955101	
Epoch	290	115.74329185486	
Epoch	291	115.83592259884	
Epoch	292	116.11644905806	
Epoch	293	115.99588912725	
Epoch	294	116.46579104662	
Epoch	295	115.45675843954	
Epoch	296	116.08084851503	
Epoch	297	115.19224488735	
Epoch	298	115.60911870003	
Epoch	299	115.1973875761	
Epoch	300	114.78500121832	
Epoch	301	115.1860615015	
Epoch	302	115.89834403992	
Epoch	303	115.84505999088	
Epoch	304	115.92591738701	
Epoch	305	116.04611688852	
Epoch	306	115.08833569288	
Epoch	307	114.69829440117	
Epoch	308	115.05113321543	
Epoch	309	115.98973196745	
Epoch	310	114.90614563227	
Epoch	311	115.66854101419	
Epoch	312	114.77927845716	
Epoch	313	115.82956475019	
Epoch	314	115.12167400122	
Epoch	315	115.68496966362	
Epoch	316	116.36418122053	
Epoch	317	114.55202776194	
Epoch	318	114.92417043447	
Epoch	319	115.08552783728	
Epoch	320	114.97511816025	
Epoch	321	114.27686977386	
Epoch	322	114.2313683033	
Epoch	323	115.33540451527	
Epoch	324	114.30492305756	
Epoch	325	114.52377718687	
Epoch	326	114.0422052145	
Epoch	327	115.38702225685	
Epoch	328	114.30471140146	
Epoch	329	114.05748695135	
Epoch	330	113.95555704832	
Epoch	331	113.51111370325	
Epoch	332	115.29741179943	
Epoch	333	114.26781004667	
Epoch	334	113.83435624838	
Epoch	335	114.77548921108	
Epoch	336	113.38601911068	
Epoch	337	113.40486347675	
Epoch	338	113.18156301975	
Epoch	339	115.02818381786	
Epoch	340	113.43012481928	
Epoch	341	113.17910432816	
Epoch	342	113.20076668262	
Epoch	343	113.93169099092	
Epoch	344	112.91339880228	
Epoch	345	113.65068972111	
Epoch	346	113.16865366697	
Epoch	347	114.20372235775	
Epoch	348	112.78335100412	
Epoch	349	114.24296945333	
Epoch	350	113.89713418484	
Epoch	351	113.98515963554	
Epoch	352	113.46601653099	
Epoch	353	113.24683582783	
Epoch	354	112.89364886284	
Epoch	355	112.78788161278	
Epoch	356	112.57620435953	
Epoch	357	112.89780282974	
Epoch	358	112.91474086046	
Epoch	359	112.80327999592	
Epoch	360	113.82732868195	
Epoch	361	113.08262878656	
Epoch	362	112.57029473782	
Epoch	363	112.13978207111	
Epoch	364	113.29919666052	
Epoch	365	113.66956460476	
Epoch	366	112.61747008562	
Epoch	367	111.92875498533	
Epoch	368	113.46457099915	
Epoch	369	112.742880404	
Epoch	370	112.47312659025	
Epoch	371	112.57822316885	
Epoch	372	112.1782143712	
Epoch	373	112.66954624653	
Epoch	374	112.36924761534	
Epoch	375	112.69146704674	
Epoch	376	111.94045966864	
Epoch	377	112.7412558198	
Epoch	378	111.67431849241	
Epoch	379	111.22121661901	
Epoch	380	112.27622175217	
Epoch	381	111.9881772995	
Epoch	382	111.85805541277	
Epoch	383	111.65912622213	
Epoch	384	112.79972815514	
Epoch	385	111.65269482136	
Epoch	386	111.25001865625	
Epoch	387	112.00367891788	
Epoch	388	111.2005354166	
Epoch	389	111.56230866909	
Epoch	390	111.5069681406	
Epoch	391	111.60632938147	
Epoch	392	111.19706231356	
Epoch	393	110.24156814814	
Epoch	394	111.95712649822	
Epoch	395	110.63363558054	
Epoch	396	110.65394222736	
Epoch	397	111.75933116674	
Epoch	398	112.06581896544	
Epoch	399	110.45327693224	
Epoch	400	110.72949886322	
Epoch	401	110.58002233505	
Epoch	402	111.92278784513	
Epoch	403	110.55076569319	
Epoch	404	111.84997028112	
Epoch	405	111.47135484219	
Epoch	406	110.55676996708	
Epoch	407	110.04525560141	
Epoch	408	109.63159996271	
Epoch	409	109.90248471498	
Epoch	410	110.93343687057	
Epoch	411	109.64195156097	
Epoch	412	110.80756598711	
Epoch	413	111.19498461485	
Epoch	414	110.03767091036	
Epoch	415	110.02844405174	
Epoch	416	109.77137941122	
Epoch	417	110.65277338028	
Epoch	418	110.97278213501	
Epoch	419	109.69298559427	
Epoch	420	109.69010692835	
Epoch	421	109.97124475241	
Epoch	422	109.89342057705	
Epoch	423	110.01569706202	
Epoch	424	108.98704761267	
Epoch	425	110.34031260014	
Epoch	426	109.30397617817	
Epoch	427	108.87411159277	
Epoch	428	109.24027764797	
Epoch	429	109.14789915085	
Epoch	430	108.95623427629	
Epoch	431	109.42525279522	
Epoch	432	108.61316114664	
Epoch	433	109.45702910423	
Epoch	434	108.84727501869	
Epoch	435	108.13243281841	
Epoch	436	108.5355271101	
Epoch	437	108.41604858637	
Epoch	438	109.50208777189	
Epoch	439	109.78060722351	
Epoch	440	108.88045614958	
Epoch	441	110.2598054409	
Epoch	442	108.16275656223	
Epoch	443	107.93805837631	
Epoch	444	107.948800385	
Epoch	445	107.81825125217	
Epoch	446	109.18105137348	
Epoch	447	107.33022487164	
Epoch	448	109.67315673828	
Epoch	449	107.79426711798	
Epoch	450	108.74963867664	
Epoch	451	108.16258490086	
Epoch	452	107.29433745146	
Epoch	453	108.08549535275	
Epoch	454	108.78494989872	
Epoch	455	107.55606043339	
Epoch	456	107.26794230938	
Epoch	457	107.43640738726	
Epoch	458	106.98235470057	
Epoch	459	108.02943378687	
Epoch	460	107.53700977564	
Epoch	461	106.28355997801	
Epoch	462	106.64113408327	
Epoch	463	106.62277561426	
Epoch	464	108.56804305315	
Epoch	465	106.91884291172	
Epoch	466	107.13778972626	
Epoch	467	106.18132120371	
Epoch	468	105.86691683531	
Epoch	469	106.01432818174	
Epoch	470	107.55056840181	
Epoch	471	107.47673881054	
Epoch	472	105.74835294485	
Epoch	473	106.00613594055	
Epoch	474	106.21989703178	
Epoch	475	107.52628284693	
Epoch	476	106.38147473335	
Epoch	477	107.13307011127	
Epoch	478	106.45772278309	
Epoch	479	105.95385247469	
Epoch	480	105.93996149302	
Epoch	481	106.76598525047	
Epoch	482	105.56003725529	
Epoch	483	106.43829852343	
Epoch	484	105.62224721909	
Epoch	485	105.40416461229	
Epoch	486	107.42248696089	
Epoch	487	106.8984079957	
Epoch	488	105.93698495626	
Epoch	489	104.9989079237	
Epoch	490	105.47376489639	
Epoch	491	106.18632215261	
Epoch	492	106.69369328022	
Epoch	493	105.51461583376	
Epoch	494	105.40016037226	
Epoch	495	105.65725469589	
Epoch	496	105.31708329916	
Epoch	497	104.59958332777	
Epoch	498	104.17954975367	
Epoch	499	105.36325842142	
Epoch	500	106.3386477232	
Epoch	501	105.0491078496	
Epoch	502	104.9960449934	
Epoch	503	105.97722429037	
Epoch	504	104.53651821613	
Epoch	505	104.7108604908	
Epoch	506	104.66390424967	
Epoch	507	105.72642862797	
Epoch	508	104.24991923571	
Epoch	509	104.97794592381	
Epoch	510	105.04085451365	
Epoch	511	106.07776868343	
Epoch	512	104.37987315655	
Epoch	513	104.19606792927	
Epoch	514	104.87861949205	
Epoch	515	105.62517303228	
Epoch	516	104.40150588751	
Epoch	517	104.97590655088	
Epoch	518	103.79191464186	
Epoch	519	104.56888824701	
Epoch	520	104.25730490685	
Epoch	521	104.19338667393	
Epoch	522	104.64553016424	
Epoch	523	103.64723283052	
Epoch	524	104.65127789974	
Epoch	525	105.05983573198	
Epoch	526	103.41318005323	
Epoch	527	103.53966510296	
Epoch	528	104.4912853837	
Epoch	529	103.86201751232	
Epoch	530	104.06027072668	
Epoch	531	103.3196169734	
Epoch	532	103.74982827902	
Epoch	533	104.36842030287	
Epoch	534	103.47516429424	
Epoch	535	103.22263813019	
Epoch	536	103.5653834939	
Epoch	537	104.45948904753	
Epoch	538	103.57993936539	
Epoch	539	103.56143343449	
Epoch	540	103.52573949099	
Epoch	541	103.42945760489	
Epoch	542	103.41412621737	
Epoch	543	103.2537509799	
Epoch	544	102.75546479225	
Epoch	545	103.51101899147	
Epoch	546	102.76486152411	
Epoch	547	102.71419680119	
Epoch	548	102.73718088865	
Epoch	549	103.85446405411	
Epoch	550	103.01801222563	
Epoch	551	103.48675537109	
Epoch	552	103.09689116478	
Epoch	553	102.76581680775	
Epoch	554	103.59442675114	
Epoch	555	103.69813245535	
Epoch	556	102.56437456608	
Epoch	557	102.70926129818	
Epoch	558	102.59130471945	
Epoch	559	103.11997300386	
Epoch	560	102.56822025776	
Epoch	561	102.79065847397	
Epoch	562	103.00585204363	
Epoch	563	102.35667949915	
Epoch	564	103.39225590229	
Epoch	565	102.82229614258	
Epoch	566	102.49515086412	
Epoch	567	102.28765046597	
Epoch	568	102.3820168972	
Epoch	569	102.44638121128	
Epoch	570	101.6919349432	
Epoch	571	102.48917633295	
Epoch	572	101.64709031582	
Epoch	573	101.50213068724	
Epoch	574	101.54064387083	
Epoch	575	102.22798907757	
Epoch	576	101.92367887497	
Epoch	577	102.61229866743	
Epoch	578	101.04194462299	
Epoch	579	102.70907968283	
Epoch	580	101.75770002604	
Epoch	581	101.01932185888	
Epoch	582	102.23633396626	
Epoch	583	101.28331512213	
Epoch	584	101.13000893593	
Epoch	585	101.66757237911	
Epoch	586	101.71563249826	
Epoch	587	101.15230190754	
Epoch	588	101.29155439138	
Epoch	589	101.19736033678	
Epoch	590	101.08060872555	
Epoch	591	101.23165673018	
Epoch	592	100.993473351	
Epoch	593	101.47853267193	
Epoch	594	101.00899869204	
Epoch	595	101.03560912609	
Epoch	596	100.70185220242	
Epoch	597	100.23848086596	
Epoch	598	100.57704484463	
Epoch	599	101.34511739016	
Epoch	600	100.42864841223	
Starting the testing	
datafile:	/n/home09/ankitgupta/CS287/CS287assignments/finalproject/PRINC_CB513_1.hdf5	classifier:	rnn	b:	128	alpha:	1	sequence_length:	100	embedding_size	500	optimizer:	sgd	epochs:	600	hidden	200	eta:	0.01	rnn_unit1	lstm	rnn_unit2	lstm	dropout	0.5	
Accuracy	0.50606242496999	
