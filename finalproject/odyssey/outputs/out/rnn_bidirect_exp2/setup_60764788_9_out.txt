[?1034hUsing cuda	
datafile:	/n/home09/ankitgupta/CS287/CS287assignments/finalproject/PRINC_CB513_1.hdf5	classifier:	rnn	b:	128	alpha:	1	sequence_length:	50	embedding_size	500	optimizer:	sgd	epochs:	600	hidden	100	eta:	0.01	rnn_unit1	lstm	rnn_unit2	lstm	dropout	0.5	
Num classes:	10	
Vocab size:	37	
Start class:	1	
Test size	     1
 83350
[torch.LongStorage of size 2]

Using cuda	
 1183318
       1
[torch.LongStorage of size 2]

  128
 9244
[torch.LongStorage of size 2]

  128
 9244
[torch.LongStorage of size 2]

Converted LSTM to CUDA	
Converted crit to CUDA	
nn.Sequential {
  [input -> (1) -> (2) -> (3) -> (4) -> (5) -> (6) -> (7) -> (8) -> (9) -> (10) -> output]
  (1): nn.LookupTable
  (2): nn.Transpose
  (3): nn.SplitTable
  (4): nn.BiSequencer @ nn.Sequential {
    [input -> (1) -> (2) -> (3) -> output]
    (1): nn.ConcatTable {
      input
        |`-> (1): nn.Sequencer @ nn.FastLSTM(500 -> 500)
        |`-> (2): nn.Sequential {
        |      [input -> (1) -> (2) -> (3) -> output]
        |      (1): nn.ReverseTable
        |      (2): nn.Sequencer @ nn.FastLSTM(500 -> 500)
        |      (3): nn.ReverseTable
        |    }
         ... -> output
    }
    (2): nn.ZipTable
    (3): nn.Sequencer @ nn.Recursor @ nn.JoinTable
  }
  (5): nn.Sequencer @ nn.Recursor @ nn.Dropout(0.5, busy)
  (6): nn.Sequencer @ nn.Recursor @ nn.Linear(1000 -> 100)
  (7): nn.Sequencer @ nn.Recursor @ nn.ReLU
  (8): nn.Sequencer @ nn.Recursor @ nn.Dropout(0.5, busy)
  (9): nn.Sequencer @ nn.Recursor @ nn.Linear(100 -> 10)
  (10): nn.Sequencer @ nn.Recursor @ nn.LogSoftMax
}
Input size	9244	
Max train index	23	
Num samples	9244	
Epoch	1	114.52140140533	
Epoch	2	71.400114059448	
Epoch	3	69.812270641327	
Epoch	4	69.412369251251	
Epoch	5	68.684181571007	
Epoch	6	67.969763875008	
Epoch	7	67.688849329948	
Epoch	8	67.455026865005	
Epoch	9	66.771325230598	
Epoch	10	67.275162100792	
Epoch	11	66.766241073608	
Epoch	12	66.788013458252	
Epoch	13	66.93158352375	
Epoch	14	67.093301415443	
Epoch	15	66.75666975975	
Epoch	16	66.515391945839	
Epoch	17	66.596051812172	
Epoch	18	66.268409609795	
Epoch	19	66.397147893906	
Epoch	20	65.87971830368	
Epoch	21	66.144046068192	
Epoch	22	65.902539253235	
Epoch	23	65.783104300499	
Epoch	24	65.729607820511	
Epoch	25	65.179993033409	
Epoch	26	65.255886673927	
Epoch	27	65.20373249054	
Epoch	28	64.594179034233	
Epoch	29	64.611590027809	
Epoch	30	64.50486934185	
Epoch	31	64.658541202545	
Epoch	32	64.289657473564	
Epoch	33	64.180104255676	
Epoch	34	64.407770514488	
Epoch	35	63.731276750565	
Epoch	36	63.717664837837	
Epoch	37	63.719313263893	
Epoch	38	63.565971374512	
Epoch	39	63.340071797371	
Epoch	40	63.294978618622	
Epoch	41	63.449964165688	
Epoch	42	63.171851992607	
Epoch	43	63.01333296299	
Epoch	44	63.401958346367	
Epoch	45	62.950598597527	
Epoch	46	63.036348581314	
Epoch	47	63.056395530701	
Epoch	48	62.541477441788	
Epoch	49	62.68535399437	
Epoch	50	62.938977003098	
Epoch	51	62.583165645599	
Epoch	52	62.160794973373	
Epoch	53	62.458528280258	
Epoch	54	62.066061377525	
Epoch	55	62.175757884979	
Epoch	56	62.018503069878	
Epoch	57	62.401873588562	
Epoch	58	62.068732142448	
Epoch	59	62.142706632614	
Epoch	60	61.68193089962	
Epoch	61	61.614888548851	
Epoch	62	61.74435532093	
Epoch	63	61.717731714249	
Epoch	64	61.436836481094	
Epoch	65	61.403189539909	
Epoch	66	61.697676062584	
Epoch	67	61.192216396332	
Epoch	68	61.289292693138	
Epoch	69	61.067395865917	
Epoch	70	61.088852107525	
Epoch	71	61.427560687065	
Epoch	72	61.349428653717	
Epoch	73	60.95375174284	
Epoch	74	60.890495717525	
Epoch	75	60.937105715275	
Epoch	76	60.920776665211	
Epoch	77	60.719699978828	
Epoch	78	60.697711348534	
Epoch	79	60.959878623486	
Epoch	80	60.66225874424	
Epoch	81	60.799143195152	
Epoch	82	60.557762563229	
Epoch	83	60.67858672142	
Epoch	84	60.705354750156	
Epoch	85	60.844843029976	
Epoch	86	60.285358965397	
Epoch	87	60.205054759979	
Epoch	88	60.326420783997	
Epoch	89	60.664465606213	
Epoch	90	60.325025677681	
Epoch	91	60.314776241779	
Epoch	92	60.367176532745	
Epoch	93	60.581395983696	
Epoch	94	60.416879594326	
Epoch	95	60.336827158928	
Epoch	96	60.387508690357	
Epoch	97	60.076572060585	
Epoch	98	60.075747489929	
Epoch	99	60.392878949642	
Epoch	100	60.07188564539	
Epoch	101	60.172298550606	
Epoch	102	59.877732396126	
Epoch	103	60.061899721622	
Epoch	104	59.949930846691	
Epoch	105	59.927102148533	
Epoch	106	60.012965381145	
Epoch	107	59.677122533321	
Epoch	108	59.775108098984	
Epoch	109	60.031605184078	
Epoch	110	59.717026472092	
Epoch	111	59.865620076656	
Epoch	112	59.92766982317	
Epoch	113	59.68683052063	
Epoch	114	59.707672059536	
Epoch	115	59.66668254137	
Epoch	116	59.968040108681	
Epoch	117	59.626907289028	
Epoch	118	59.499001026154	
Epoch	119	59.515850543976	
Epoch	120	59.710587203503	
Epoch	121	59.541589081287	
Epoch	122	59.676211535931	
Epoch	123	59.553209245205	
Epoch	124	59.844098091125	
Epoch	125	59.273395657539	
Epoch	126	59.278293311596	
Epoch	127	59.284478545189	
Epoch	128	59.355176210403	
Epoch	129	59.55806440115	
Epoch	130	59.10378921032	
Epoch	131	59.353391170502	
Epoch	132	58.919814288616	
Epoch	133	59.376641750336	
Epoch	134	58.859692394733	
Epoch	135	59.271281421185	
Epoch	136	59.079177975655	
Epoch	137	58.789114892483	
Epoch	138	58.840193986893	
Epoch	139	58.891025543213	
Epoch	140	58.947247684002	
Epoch	141	58.757068932056	
Epoch	142	59.431656718254	
Epoch	143	58.912591099739	
Epoch	144	58.629692912102	
Epoch	145	58.919871628284	
Epoch	146	59.06599855423	
Epoch	147	59.001715242863	
Epoch	148	58.845239520073	
Epoch	149	58.943900585175	
Epoch	150	58.589797258377	
Epoch	151	58.622624576092	
Epoch	152	58.504149019718	
Epoch	153	58.634131729603	
Epoch	154	58.72973716259	
Epoch	155	58.719969391823	
Epoch	156	58.550442814827	
Epoch	157	58.058253645897	
Epoch	158	57.943114757538	
Epoch	159	58.048682570457	
Epoch	160	58.490299224854	
Epoch	161	58.450319945812	
Epoch	162	58.403798758984	
Epoch	163	58.654396295547	
Epoch	164	58.436984539032	
Epoch	165	58.405505418777	
Epoch	166	58.026148736477	
Epoch	167	58.380494773388	
Epoch	168	58.082623183727	
Epoch	169	57.762861073017	
Epoch	170	57.824455440044	
Epoch	171	57.638991296291	
Epoch	172	58.0074827075	
Epoch	173	57.52566587925	
Epoch	174	57.430678009987	
Epoch	175	57.864275276661	
Epoch	176	57.935840904713	
Epoch	177	57.818665146828	
Epoch	178	57.774999439716	
Epoch	179	57.840573549271	
Epoch	180	57.451593101025	
Epoch	181	57.358015775681	
Epoch	182	57.372254014015	
Epoch	183	57.399574458599	
Epoch	184	57.490344762802	
Epoch	185	57.306006908417	
Epoch	186	57.503224790096	
Epoch	187	57.102367281914	
Epoch	188	57.064814627171	
Epoch	189	57.064908325672	
Epoch	190	57.197496771812	
Epoch	191	57.008184850216	
Epoch	192	56.705888986588	
Epoch	193	56.865638315678	
Epoch	194	57.051712989807	
Epoch	195	56.802293181419	
Epoch	196	56.738907217979	
Epoch	197	56.695588052273	
Epoch	198	56.689634919167	
Epoch	199	56.478470921516	
Epoch	200	56.140822470188	
Epoch	201	56.217505514622	
Epoch	202	56.553100585938	
Epoch	203	56.447009921074	
Epoch	204	56.380044877529	
Epoch	205	56.298937320709	
Epoch	206	56.00544577837	
Epoch	207	55.934317350388	
Epoch	208	56.044366002083	
Epoch	209	55.822430253029	
Epoch	210	55.990208029747	
Epoch	211	55.6856777668	
Epoch	212	56.049593806267	
Epoch	213	55.834058225155	
Epoch	214	55.731187999249	
Epoch	215	56.113396346569	
Epoch	216	55.858067989349	
Epoch	217	55.783528804779	
Epoch	218	55.299098789692	
Epoch	219	55.591994941235	
Epoch	220	55.301062881947	
Epoch	221	55.214610934258	
Epoch	222	54.94483923912	
Epoch	223	54.99049693346	
Epoch	224	55.441960632801	
Epoch	225	54.944259524345	
Epoch	226	54.768366158009	
Epoch	227	54.977490961552	
Epoch	228	54.873871743679	
Epoch	229	54.752028167248	
Epoch	230	54.795186758041	
Epoch	231	54.763042807579	
Epoch	232	54.596036672592	
Epoch	233	54.320624113083	
Epoch	234	54.718348741531	
Epoch	235	54.363469481468	
Epoch	236	54.489706158638	
Epoch	237	54.447056651115	
Epoch	238	54.486531615257	
Epoch	239	54.398304879665	
Epoch	240	54.394743144512	
Epoch	241	54.085141122341	
Epoch	242	54.151885151863	
Epoch	243	54.140517413616	
Epoch	244	53.746854305267	
Epoch	245	53.820511639118	
Epoch	246	53.901399552822	
Epoch	247	53.89093619585	
Epoch	248	53.480338871479	
Epoch	249	53.835416793823	
Epoch	250	53.955244362354	
Epoch	251	53.652149677277	
Epoch	252	53.146004617214	
Epoch	253	53.276617348194	
Epoch	254	53.208937287331	
Epoch	255	53.25940901041	
Epoch	256	53.503215551376	
Epoch	257	53.354736864567	
Epoch	258	53.611552238464	
Epoch	259	52.967713356018	
Epoch	260	52.704828023911	
Epoch	261	52.963750183582	
Epoch	262	52.851169407368	
Epoch	263	52.696115553379	
Epoch	264	52.867962241173	
Epoch	265	52.586424171925	
Epoch	266	53.2718116045	
Epoch	267	52.480315923691	
Epoch	268	52.858938753605	
Epoch	269	52.149936079979	
Epoch	270	52.748545229435	
Epoch	271	52.448444247246	
Epoch	272	52.244468033314	
Epoch	273	53.351952254772	
Epoch	274	52.475315153599	
Epoch	275	52.44405156374	
Epoch	276	52.099610090256	
Epoch	277	52.591272354126	
Epoch	278	52.212948620319	
Epoch	279	52.354732632637	
Epoch	280	52.418059885502	
Epoch	281	51.799752473831	
Epoch	282	53.008487701416	
Epoch	283	51.961860120296	
Epoch	284	52.149954974651	
Epoch	285	51.940991997719	
Epoch	286	51.5831553936	
Epoch	287	51.67139595747	
Epoch	288	51.700847327709	
Epoch	289	51.789509057999	
Epoch	290	52.298349201679	
Epoch	291	52.250261962414	
Epoch	292	51.701064109802	
Epoch	293	52.030350744724	
Epoch	294	51.530674993992	
Epoch	295	52.26777946949	
Epoch	296	51.426698386669	
Epoch	297	51.593916416168	
Epoch	298	51.345193564892	
Epoch	299	51.128164231777	
Epoch	300	51.20800101757	
Epoch	301	52.014832854271	
Epoch	302	51.385179340839	
Epoch	303	51.135786056519	
Epoch	304	50.676759719849	
Epoch	305	51.937368512154	
Epoch	306	51.065500736237	
Epoch	307	51.532777070999	
Epoch	308	50.737721562386	
Epoch	309	50.925500035286	
Epoch	310	51.644978940487	
Epoch	311	51.890637814999	
Epoch	312	51.229321360588	
Epoch	313	50.648405373096	
Epoch	314	51.578861653805	
Epoch	315	50.9001557827	
Epoch	316	51.279347598553	
Epoch	317	50.944538533688	
Epoch	318	50.397381961346	
Epoch	319	50.900627017021	
Epoch	320	50.74152135849	
Epoch	321	50.009673237801	
Epoch	322	51.190589189529	
Epoch	323	50.862008094788	
Epoch	324	50.766868293285	
Epoch	325	50.740570425987	
Epoch	326	50.538201630116	
Epoch	327	50.756695747375	
Epoch	328	50.72485435009	
Epoch	329	50.219324469566	
Epoch	330	50.934058010578	
Epoch	331	50.957922101021	
Epoch	332	50.103306293488	
Epoch	333	50.696159541607	
Epoch	334	50.448626935482	
Epoch	335	50.061459720135	
Epoch	336	50.344763100147	
Epoch	337	50.729005098343	
Epoch	338	50.650537669659	
Epoch	339	49.963455975056	
Epoch	340	49.901688992977	
Epoch	341	49.984764397144	
Epoch	342	50.531705915928	
Epoch	343	50.441236495972	
Epoch	344	49.715829432011	
Epoch	345	50.17247992754	
Epoch	346	50.165061950684	
Epoch	347	50.034696578979	
Epoch	348	50.209533929825	
Epoch	349	49.645344853401	
Epoch	350	49.452752053738	
Epoch	351	50.356045484543	
Epoch	352	49.887361228466	
Epoch	353	50.315042316914	
Epoch	354	49.559900820255	
Epoch	355	50.088087916374	
Epoch	356	49.991405367851	
Epoch	357	49.302776157856	
Epoch	358	49.867504894733	
Epoch	359	49.661974787712	
Epoch	360	48.881075561047	
Epoch	361	49.210444808006	
Epoch	362	49.81247651577	
Epoch	363	49.355197787285	
Epoch	364	49.439040362835	
Epoch	365	50.320091366768	
Epoch	366	49.885790407658	
Epoch	367	48.80907613039	
Epoch	368	48.972406804562	
Epoch	369	48.762804806232	
Epoch	370	49.035042762756	
Epoch	371	49.154275476933	
Epoch	372	50.324470043182	
Epoch	373	49.852980136871	
Epoch	374	48.807606458664	
Epoch	375	49.277970910072	
Epoch	376	48.623870909214	
Epoch	377	49.430090904236	
Epoch	378	48.974017560482	
Epoch	379	48.606464266777	
Epoch	380	48.787678182125	
Epoch	381	49.345475912094	
Epoch	382	48.9531031847	
Epoch	383	48.501508116722	
Epoch	384	49.490631401539	
Epoch	385	49.223305106163	
Epoch	386	48.98241353035	
Epoch	387	48.134670436382	
Epoch	388	49.220080077648	
Epoch	389	48.511257886887	
Epoch	390	48.058296263218	
Epoch	391	47.9955971241	
Epoch	392	48.597065031528	
Epoch	393	49.051068544388	
Epoch	394	48.365821123123	
Epoch	395	48.224299669266	
Epoch	396	47.941805005074	
Epoch	397	49.011590898037	
Epoch	398	48.437605261803	
Epoch	399	47.904545783997	
Epoch	400	48.773637652397	
Epoch	401	48.215965569019	
Epoch	402	48.81149327755	
Epoch	403	48.458568930626	
Epoch	404	48.438563346863	
Epoch	405	48.256140053272	
Epoch	406	47.81500095129	
Epoch	407	48.295964896679	
Epoch	408	47.593133807182	
Epoch	409	48.200939118862	
Epoch	410	48.411553502083	
Epoch	411	47.800918102264	
Epoch	412	48.204687058926	
Epoch	413	48.471231281757	
Epoch	414	48.406107366085	
Epoch	415	48.000151515007	
Epoch	416	47.901932299137	
Epoch	417	48.089481174946	
Epoch	418	47.362605929375	
Epoch	419	47.37301158905	
Epoch	420	47.994153857231	
Epoch	421	47.224427103996	
Epoch	422	47.600952744484	
Epoch	423	47.063623011112	
Epoch	424	47.746068954468	
Epoch	425	47.305469036102	
Epoch	426	48.140891849995	
Epoch	427	47.124317646027	
Epoch	428	47.919626295567	
Epoch	429	48.034519731998	
Epoch	430	47.169937610626	
Epoch	431	47.53740209341	
Epoch	432	47.340702116489	
Epoch	433	47.074366688728	
Epoch	434	47.242040216923	
Epoch	435	47.019650101662	
Epoch	436	46.619407892227	
Epoch	437	47.669206738472	
Epoch	438	46.650891840458	
Epoch	439	47.877761244774	
Epoch	440	47.969202458858	
Epoch	441	47.063591301441	
Epoch	442	46.546850264072	
Epoch	443	47.019018292427	
Epoch	444	47.688779532909	
Epoch	445	47.267271697521	
Epoch	446	46.646878778934	
Epoch	447	46.63392418623	
Epoch	448	48.089539170265	
Epoch	449	46.628509640694	
Epoch	450	46.302903711796	
Epoch	451	47.603583157063	
Epoch	452	46.047168374062	
Epoch	453	46.52344751358	
Epoch	454	47.466525375843	
Epoch	455	47.56319129467	
Epoch	456	46.809362769127	
Epoch	457	47.097316503525	
Epoch	458	47.258639574051	
Epoch	459	46.322954416275	
Epoch	460	46.716424703598	
Epoch	461	46.623563468456	
Epoch	462	46.080981850624	
Epoch	463	46.410630226135	
Epoch	464	45.634933054447	
Epoch	465	47.423216342926	
Epoch	466	45.701673567295	
Epoch	467	45.980728387833	
Epoch	468	46.134426474571	
Epoch	469	46.958319723606	
Epoch	470	45.745144248009	
Epoch	471	46.440237402916	
Epoch	472	46.319569468498	
Epoch	473	46.028228878975	
Epoch	474	46.377858042717	
Epoch	475	45.711083710194	
Epoch	476	46.474659502506	
Epoch	477	46.472436487675	
Epoch	478	45.572767436504	
Epoch	479	46.470982670784	
Epoch	480	46.705987989902	
Epoch	481	45.795241236687	
Epoch	482	46.894840955734	
Epoch	483	45.592056632042	
Epoch	484	45.814849257469	
Epoch	485	46.134976863861	
Epoch	486	45.489348948002	
Epoch	487	45.835432946682	
Epoch	488	45.248805820942	
Epoch	489	45.950584709644	
Epoch	490	46.152886390686	
Epoch	491	45.307373404503	
Epoch	492	45.463505983353	
Epoch	493	46.271900594234	
Epoch	494	45.821042060852	
Epoch	495	45.564838051796	
Epoch	496	45.535380005836	
Epoch	497	45.762184083462	
Epoch	498	44.760005891323	
Epoch	499	45.46896982193	
Epoch	500	45.37781727314	
Epoch	501	46.00191193819	
Epoch	502	45.25770097971	
Epoch	503	45.573895037174	
Epoch	504	45.055515289307	
Epoch	505	45.448059916496	
Epoch	506	45.806892216206	
Epoch	507	45.317050039768	
Epoch	508	45.978698849678	
Epoch	509	45.50199007988	
Epoch	510	45.604997336864	
Epoch	511	44.793143868446	
Epoch	512	45.290276587009	
Epoch	513	45.118580400944	
Epoch	514	45.229842424393	
Epoch	515	45.328725874424	
Epoch	516	45.025942564011	
Epoch	517	45.229893803596	
Epoch	518	44.937395334244	
Epoch	519	44.919614911079	
Epoch	520	44.939478874207	
Epoch	521	44.548556268215	
Epoch	522	45.329898953438	
Epoch	523	45.071678221226	
Epoch	524	44.881182074547	
Epoch	525	45.034611225128	
Epoch	526	44.969648420811	
Epoch	527	44.772979915142	
Epoch	528	45.556559920311	
Epoch	529	44.347700297832	
Epoch	530	44.902828097343	
Epoch	531	45.109520435333	
Epoch	532	44.824764370918	
Epoch	533	44.276807367802	
Epoch	534	45.393565535545	
Epoch	535	44.465691268444	
Epoch	536	44.539647042751	
Epoch	537	44.033065855503	
Epoch	538	44.8143440485	
Epoch	539	45.181006729603	
Epoch	540	44.431719064713	
Epoch	541	45.328368782997	
Epoch	542	44.546527564526	
Epoch	543	44.323120832443	
Epoch	544	44.355584204197	
Epoch	545	44.340376138687	
Epoch	546	45.474129140377	
Epoch	547	44.406221628189	
Epoch	548	44.361323952675	
Epoch	549	44.689070165157	
Epoch	550	44.040361642838	
Epoch	551	44.213238537312	
Epoch	552	43.66158592701	
Epoch	553	44.04657125473	
Epoch	554	44.675839185715	
Epoch	555	43.949594914913	
Epoch	556	44.579618275166	
Epoch	557	43.933751821518	
Epoch	558	43.765820145607	
Epoch	559	43.612144589424	
Epoch	560	44.414511322975	
Epoch	561	44.754616737366	
Epoch	562	44.304746866226	
Epoch	563	44.104795634747	
Epoch	564	44.209898710251	
Epoch	565	43.155480563641	
Epoch	566	44.071120738983	
Epoch	567	43.474711596966	
Epoch	568	43.786448121071	
Epoch	569	43.339756071568	
Epoch	570	43.587433755398	
Epoch	571	43.830080509186	
Epoch	572	43.559460997581	
Epoch	573	43.619198203087	
Epoch	574	44.018391489983	
Epoch	575	43.570500791073	
Epoch	576	43.510801255703	
Epoch	577	43.870101809502	
Epoch	578	43.820101320744	
Epoch	579	43.693871438503	
Epoch	580	43.098458826542	
Epoch	581	43.390156149864	
Epoch	582	43.822226345539	
Epoch	583	43.61442810297	
Epoch	584	43.226503252983	
Epoch	585	43.319906592369	
Epoch	586	44.528115034103	
Epoch	587	43.131119549274	
Epoch	588	43.810947597027	
Epoch	589	43.583762228489	
Epoch	590	43.495005249977	
Epoch	591	42.946416079998	
Epoch	592	43.434302508831	
Epoch	593	43.021835505962	
Epoch	594	43.166657984257	
Epoch	595	43.133248090744	
Epoch	596	43.897353231907	
Epoch	597	43.296545267105	
Epoch	598	42.702351748943	
Epoch	599	43.317363202572	
Epoch	600	43.334567368031	
Starting the testing	
datafile:	/n/home09/ankitgupta/CS287/CS287assignments/finalproject/PRINC_CB513_1.hdf5	classifier:	rnn	b:	128	alpha:	1	sequence_length:	50	embedding_size	500	optimizer:	sgd	epochs:	600	hidden	100	eta:	0.01	rnn_unit1	lstm	rnn_unit2	lstm	dropout	0.5	
Accuracy	0.46616676664667	
