[?1034hUsing cuda	
datafile:	/n/home09/ankitgupta/CS287/CS287assignments/finalproject/PRINC_CB513_1.hdf5	classifier:	rnn	b:	128	alpha:	1	sequence_length:	50	embedding_size	500	optimizer:	sgd	epochs:	600	hidden	200	eta:	0.01	rnn_unit1	lstm	rnn_unit2	lstm	dropout	0.5	
Num classes:	10	
Vocab size:	37	
Start class:	1	
Test size	     1
 83350
[torch.LongStorage of size 2]

Using cuda	
 1183318
       1
[torch.LongStorage of size 2]

  128
 9244
[torch.LongStorage of size 2]

  128
 9244
[torch.LongStorage of size 2]

Converted LSTM to CUDA	
Converted crit to CUDA	
nn.Sequential {
  [input -> (1) -> (2) -> (3) -> (4) -> (5) -> (6) -> (7) -> (8) -> (9) -> (10) -> output]
  (1): nn.LookupTable
  (2): nn.Transpose
  (3): nn.SplitTable
  (4): nn.BiSequencer @ nn.Sequential {
    [input -> (1) -> (2) -> (3) -> output]
    (1): nn.ConcatTable {
      input
        |`-> (1): nn.Sequencer @ nn.FastLSTM(500 -> 500)
        |`-> (2): nn.Sequential {
        |      [input -> (1) -> (2) -> (3) -> output]
        |      (1): nn.ReverseTable
        |      (2): nn.Sequencer @ nn.FastLSTM(500 -> 500)
        |      (3): nn.ReverseTable
        |    }
         ... -> output
    }
    (2): nn.ZipTable
    (3): nn.Sequencer @ nn.Recursor @ nn.JoinTable
  }
  (5): nn.Sequencer @ nn.Recursor @ nn.Dropout(0.5, busy)
  (6): nn.Sequencer @ nn.Recursor @ nn.Linear(1000 -> 200)
  (7): nn.Sequencer @ nn.Recursor @ nn.ReLU
  (8): nn.Sequencer @ nn.Recursor @ nn.Dropout(0.5, busy)
  (9): nn.Sequencer @ nn.Recursor @ nn.Linear(200 -> 10)
  (10): nn.Sequencer @ nn.Recursor @ nn.LogSoftMax
}
Input size	9244	
Max train index	23	
Num samples	9244	
Epoch	1	115.07720017433	
Epoch	2	71.025297403336	
Epoch	3	69.565461993217	
Epoch	4	68.590193033218	
Epoch	5	68.114182472229	
Epoch	6	67.655178666115	
Epoch	7	67.221366882324	
Epoch	8	67.067531704903	
Epoch	9	66.63505423069	
Epoch	10	66.168587327003	
Epoch	11	66.288212060928	
Epoch	12	65.721661090851	
Epoch	13	65.802876234055	
Epoch	14	65.995155334473	
Epoch	15	65.82954621315	
Epoch	16	65.722810149193	
Epoch	17	65.659860730171	
Epoch	18	65.383216977119	
Epoch	19	65.37949860096	
Epoch	20	65.003717780113	
Epoch	21	65.130469202995	
Epoch	22	64.899784803391	
Epoch	23	64.845864295959	
Epoch	24	64.772919178009	
Epoch	25	64.605781316757	
Epoch	26	64.183167219162	
Epoch	27	64.093672633171	
Epoch	28	64.257499694824	
Epoch	29	64.513455867767	
Epoch	30	64.089272975922	
Epoch	31	63.825900197029	
Epoch	32	63.695383906364	
Epoch	33	63.882058978081	
Epoch	34	63.80183172226	
Epoch	35	63.483086466789	
Epoch	36	63.466697216034	
Epoch	37	63.418784737587	
Epoch	38	62.891746401787	
Epoch	39	63.069287896156	
Epoch	40	63.01867711544	
Epoch	41	63.059119284153	
Epoch	42	62.792084574699	
Epoch	43	62.743788719177	
Epoch	44	62.57674908638	
Epoch	45	62.428409218788	
Epoch	46	62.321103692055	
Epoch	47	62.411163926125	
Epoch	48	62.369030237198	
Epoch	49	61.902775645256	
Epoch	50	62.286043763161	
Epoch	51	61.750566840172	
Epoch	52	62.073844432831	
Epoch	53	61.876098155975	
Epoch	54	61.632793962955	
Epoch	55	61.609303474426	
Epoch	56	61.361329555511	
Epoch	57	61.32245028019	
Epoch	58	61.503889679909	
Epoch	59	61.262651205063	
Epoch	60	61.192331671715	
Epoch	61	61.090500712395	
Epoch	62	60.842958331108	
Epoch	63	61.212272584438	
Epoch	64	61.041330397129	
Epoch	65	60.623095750809	
Epoch	66	60.889162242413	
Epoch	67	60.6512119174	
Epoch	68	60.769974887371	
Epoch	69	60.554612457752	
Epoch	70	60.745869636536	
Epoch	71	60.62939786911	
Epoch	72	60.651893794537	
Epoch	73	60.501235246658	
Epoch	74	60.416799247265	
Epoch	75	60.408804059029	
Epoch	76	60.513217329979	
Epoch	77	60.417680501938	
Epoch	78	60.293309986591	
Epoch	79	60.302035152912	
Epoch	80	60.095605492592	
Epoch	81	59.948204874992	
Epoch	82	59.879025638103	
Epoch	83	60.110704958439	
Epoch	84	60.083077251911	
Epoch	85	59.957179963589	
Epoch	86	59.980501234531	
Epoch	87	59.951619625092	
Epoch	88	59.940138757229	
Epoch	89	59.773908615112	
Epoch	90	59.731730163097	
Epoch	91	59.856075465679	
Epoch	92	59.756264090538	
Epoch	93	59.896632492542	
Epoch	94	59.71877104044	
Epoch	95	59.833227694035	
Epoch	96	59.446541845798	
Epoch	97	59.808902204037	
Epoch	98	59.7669531703	
Epoch	99	59.571884453297	
Epoch	100	59.578621804714	
Epoch	101	59.58349776268	
Epoch	102	59.304751634598	
Epoch	103	59.492106676102	
Epoch	104	59.687174081802	
Epoch	105	59.497749090195	
Epoch	106	59.530963420868	
Epoch	107	59.171616137028	
Epoch	108	59.207725703716	
Epoch	109	59.150032699108	
Epoch	110	59.391814351082	
Epoch	111	59.231621444225	
Epoch	112	59.015847921371	
Epoch	113	59.205433607101	
Epoch	114	59.306470990181	
Epoch	115	59.322662472725	
Epoch	116	58.823879897594	
Epoch	117	59.233035802841	
Epoch	118	59.052939176559	
Epoch	119	58.927042067051	
Epoch	120	58.760448098183	
Epoch	121	58.587527215481	
Epoch	122	58.814348399639	
Epoch	123	58.83886039257	
Epoch	124	58.746261954308	
Epoch	125	58.770426392555	
Epoch	126	58.622768521309	
Epoch	127	58.900890767574	
Epoch	128	58.369241058826	
Epoch	129	58.649161338806	
Epoch	130	58.520849227905	
Epoch	131	58.620605707169	
Epoch	132	58.70503950119	
Epoch	133	58.225284695625	
Epoch	134	58.304288089275	
Epoch	135	58.328937113285	
Epoch	136	58.003055870533	
Epoch	137	58.443866610527	
Epoch	138	58.350504100323	
Epoch	139	58.205016672611	
Epoch	140	58.162141978741	
Epoch	141	58.071436226368	
Epoch	142	58.223176777363	
Epoch	143	58.120557367802	
Epoch	144	57.871402263641	
Epoch	145	57.726827025414	
Epoch	146	57.945633411407	
Epoch	147	58.077191770077	
Epoch	148	57.881871163845	
Epoch	149	58.049232184887	
Epoch	150	57.664719820023	
Epoch	151	57.727358400822	
Epoch	152	57.39799952507	
Epoch	153	57.567133486271	
Epoch	154	57.509369552135	
Epoch	155	57.756129682064	
Epoch	156	57.923201322556	
Epoch	157	57.599987566471	
Epoch	158	57.916796386242	
Epoch	159	57.764821887016	
Epoch	160	57.752314329147	
Epoch	161	57.598845779896	
Epoch	162	57.669568121433	
Epoch	163	57.500691890717	
Epoch	164	57.102891206741	
Epoch	165	57.865921914577	
Epoch	166	57.858685493469	
Epoch	167	57.701974093914	
Epoch	168	57.630282580853	
Epoch	169	57.149573981762	
Epoch	170	57.413605391979	
Epoch	171	57.342983901501	
Epoch	172	57.147036135197	
Epoch	173	57.006782710552	
Epoch	174	57.470189154148	
Epoch	175	57.830964386463	
Epoch	176	57.578510165215	
Epoch	177	57.375843882561	
Epoch	178	57.159247994423	
Epoch	179	57.335988461971	
Epoch	180	57.07040733099	
Epoch	181	57.559767067432	
Epoch	182	57.417522966862	
Epoch	183	57.124508202076	
Epoch	184	57.294043600559	
Epoch	185	56.980464994907	
Epoch	186	57.458439230919	
Epoch	187	57.424530029297	
Epoch	188	56.85265737772	
Epoch	189	57.426149368286	
Epoch	190	56.905320286751	
Epoch	191	57.20917314291	
Epoch	192	57.122099220753	
Epoch	193	57.342468798161	
Epoch	194	57.188585519791	
Epoch	195	57.033567011356	
Epoch	196	57.13496106863	
Epoch	197	57.070318102837	
Epoch	198	56.724073767662	
Epoch	199	57.060258924961	
Epoch	200	56.92987537384	
Epoch	201	56.839293539524	
Epoch	202	56.872807681561	
Epoch	203	56.61067956686	
Epoch	204	56.971056520939	
Epoch	205	56.312797784805	
Epoch	206	56.712722599506	
Epoch	207	56.279239356518	
Epoch	208	56.635758280754	
Epoch	209	56.800476670265	
Epoch	210	56.56160402298	
Epoch	211	56.411033511162	
Epoch	212	56.488910973072	
Epoch	213	56.397374749184	
Epoch	214	56.112481415272	
Epoch	215	56.23395550251	
Epoch	216	56.349676847458	
Epoch	217	56.369662642479	
Epoch	218	56.142836749554	
Epoch	219	56.598083019257	
Epoch	220	56.324839055538	
Epoch	221	55.998921275139	
Epoch	222	55.941626429558	
Epoch	223	56.191549301147	
Epoch	224	55.889681994915	
Epoch	225	55.952701985836	
Epoch	226	55.646532356739	
Epoch	227	55.90187305212	
Epoch	228	55.986861348152	
Epoch	229	56.143147647381	
Epoch	230	56.348177373409	
Epoch	231	56.134961307049	
Epoch	232	55.903953373432	
Epoch	233	56.460974633694	
Epoch	234	56.102390646935	
Epoch	235	55.354963243008	
Epoch	236	56.032159626484	
Epoch	237	55.75903660059	
Epoch	238	55.323059976101	
Epoch	239	55.568157970905	
Epoch	240	55.63391917944	
Epoch	241	55.362936019897	
Epoch	242	55.471753299236	
Epoch	243	55.488625764847	
Epoch	244	55.341093480587	
Epoch	245	55.377117037773	
Epoch	246	55.587707936764	
Epoch	247	55.267535924911	
Epoch	248	54.694578230381	
Epoch	249	54.982117474079	
Epoch	250	55.042419910431	
Epoch	251	55.188205301762	
Epoch	252	55.273711621761	
Epoch	253	54.707229316235	
Epoch	254	54.942278325558	
Epoch	255	55.387052476406	
Epoch	256	54.605011820793	
Epoch	257	54.717461049557	
Epoch	258	54.986752569675	
Epoch	259	54.419352293015	
Epoch	260	54.388691425323	
Epoch	261	54.550884723663	
Epoch	262	54.489662647247	
Epoch	263	54.922305762768	
Epoch	264	54.969013571739	
Epoch	265	54.539639353752	
Epoch	266	54.370198309422	
Epoch	267	54.312589347363	
Epoch	268	54.417935907841	
Epoch	269	54.135658740997	
Epoch	270	54.320179343224	
Epoch	271	54.587220847607	
Epoch	272	54.104651689529	
Epoch	273	54.357718169689	
Epoch	274	53.990811526775	
Epoch	275	53.960711836815	
Epoch	276	54.051180779934	
Epoch	277	54.150006949902	
Epoch	278	54.256036520004	
Epoch	279	53.98234307766	
Epoch	280	53.334700763226	
Epoch	281	52.996794760227	
Epoch	282	53.764052510262	
Epoch	283	53.469605147839	
Epoch	284	53.111672341824	
Epoch	285	53.838349401951	
Epoch	286	53.520273208618	
Epoch	287	53.379783391953	
Epoch	288	53.191734731197	
Epoch	289	53.816291570663	
Epoch	290	53.499910414219	
Epoch	291	53.161333322525	
Epoch	292	53.581012427807	
Epoch	293	52.9312748909	
Epoch	294	52.76489084959	
Epoch	295	52.74749994278	
Epoch	296	53.34685921669	
Epoch	297	53.213013291359	
Epoch	298	53.756692051888	
Epoch	299	52.6885009408	
Epoch	300	52.63399875164	
Epoch	301	53.488897025585	
Epoch	302	53.388902664185	
Epoch	303	52.755479991436	
Epoch	304	52.985425829887	
Epoch	305	53.175974607468	
Epoch	306	52.69456243515	
Epoch	307	53.101208031178	
Epoch	308	52.661424219608	
Epoch	309	52.862165391445	
Epoch	310	53.344397783279	
Epoch	311	53.631621718407	
Epoch	312	52.964493632317	
Epoch	313	53.283444881439	
Epoch	314	52.6271956563	
Epoch	315	52.744853317738	
Epoch	316	52.440397381783	
Epoch	317	53.111628055573	
Epoch	318	52.747986614704	
Epoch	319	52.718362927437	
Epoch	320	52.084210216999	
Epoch	321	52.031070351601	
Epoch	322	53.238880455494	
Epoch	323	52.23190331459	
Epoch	324	52.408007800579	
Epoch	325	51.904056608677	
Epoch	326	52.358445584774	
Epoch	327	52.274608373642	
Epoch	328	52.598958432674	
Epoch	329	53.066079854965	
Epoch	330	51.955326557159	
Epoch	331	52.885704994202	
Epoch	332	52.480572938919	
Epoch	333	52.39050090313	
Epoch	334	51.618917226791	
Epoch	335	52.762603223324	
Epoch	336	52.113731980324	
Epoch	337	51.878359556198	
Epoch	338	52.539980053902	
Epoch	339	51.786922216415	
Epoch	340	51.39461940527	
Epoch	341	51.800986170769	
Epoch	342	51.519313275814	
Epoch	343	51.896516084671	
Epoch	344	51.511017143726	
Epoch	345	52.8139321208	
Epoch	346	51.653510332108	
Epoch	347	51.325227975845	
Epoch	348	51.755239188671	
Epoch	349	50.853209257126	
Epoch	350	51.498576045036	
Epoch	351	50.844653308392	
Epoch	352	51.098737776279	
Epoch	353	51.046378850937	
Epoch	354	52.190197110176	
Epoch	355	51.442243933678	
Epoch	356	51.814812421799	
Epoch	357	50.902440845966	
Epoch	358	50.800185441971	
Epoch	359	50.839959084988	
Epoch	360	51.527618408203	
Epoch	361	50.868891298771	
Epoch	362	50.691294133663	
Epoch	363	51.301475584507	
Epoch	364	50.761268377304	
Epoch	365	51.009739637375	
Epoch	366	51.005896091461	
Epoch	367	50.925959944725	
Epoch	368	50.623760044575	
Epoch	369	51.094629824162	
Epoch	370	50.28435343504	
Epoch	371	50.226557850838	
Epoch	372	51.08710026741	
Epoch	373	50.326641976833	
Epoch	374	50.81005859375	
Epoch	375	50.078681230545	
Epoch	376	50.766192793846	
Epoch	377	50.688705682755	
Epoch	378	50.100963115692	
Epoch	379	50.005248248577	
Epoch	380	50.683980882168	
Epoch	381	49.833166480064	
Epoch	382	50.667070627213	
Epoch	383	50.476560413837	
Epoch	384	49.626994431019	
Epoch	385	49.691369116306	
Epoch	386	49.254868209362	
Epoch	387	49.846033632755	
Epoch	388	50.122758388519	
Epoch	389	49.829723536968	
Epoch	390	49.829420268536	
Epoch	391	49.341526985168	
Epoch	392	50.059508442879	
Epoch	393	50.046192169189	
Epoch	394	49.524358391762	
Epoch	395	49.028446018696	
Epoch	396	49.461969733238	
Epoch	397	49.982147336006	
Epoch	398	50.082436084747	
Epoch	399	49.341270089149	
Epoch	400	49.222737729549	
Epoch	401	49.911317050457	
Epoch	402	48.961198985577	
Epoch	403	49.13172763586	
Epoch	404	51.159864842892	
Epoch	405	49.296870708466	
Epoch	406	48.942344844341	
Epoch	407	48.982807278633	
Epoch	408	49.495899200439	
Epoch	409	49.649771273136	
Epoch	410	48.987860918045	
Epoch	411	48.964406967163	
Epoch	412	49.883589506149	
Epoch	413	49.254700303078	
Epoch	414	48.883742153645	
Epoch	415	48.936874210835	
Epoch	416	48.937835097313	
Epoch	417	49.053246259689	
Epoch	418	49.072719633579	
Epoch	419	48.679801523685	
Epoch	420	49.200756430626	
Epoch	421	49.181831777096	
Epoch	422	48.258440077305	
Epoch	423	48.16352802515	
Epoch	424	48.505118370056	
Epoch	425	48.485809147358	
Epoch	426	47.94635862112	
Epoch	427	49.047666728497	
Epoch	428	48.495207607746	
Epoch	429	48.480824172497	
Epoch	430	48.619632303715	
Epoch	431	48.749379754066	
Epoch	432	48.003841400146	
Epoch	433	48.077771365643	
Epoch	434	48.483754038811	
Epoch	435	48.321059465408	
Epoch	436	47.991629362106	
Epoch	437	49.057667791843	
Epoch	438	48.179114282131	
Epoch	439	48.783367574215	
Epoch	440	48.588896095753	
Epoch	441	48.861546635628	
Epoch	442	48.900749862194	
Epoch	443	48.661617159843	
Epoch	444	48.335211217403	
Epoch	445	48.020161390305	
Epoch	446	47.990432798862	
Epoch	447	47.866909742355	
Epoch	448	47.870283842087	
Epoch	449	47.860968768597	
Epoch	450	48.15112298727	
Epoch	451	48.379394173622	
Epoch	452	47.783372759819	
Epoch	453	47.678895890713	
Epoch	454	47.665699958801	
Epoch	455	48.601687073708	
Epoch	456	47.321731567383	
Epoch	457	48.243100881577	
Epoch	458	48.665834486485	
Epoch	459	48.031595408916	
Epoch	460	47.429355442524	
Epoch	461	48.034824252129	
Epoch	462	47.682132184505	
Epoch	463	47.674923658371	
Epoch	464	47.598439455032	
Epoch	465	47.51780718565	
Epoch	466	47.534195482731	
Epoch	467	47.08831268549	
Epoch	468	47.687675356865	
Epoch	469	46.622770309448	
Epoch	470	47.954400897026	
Epoch	471	46.92601287365	
Epoch	472	47.414073646069	
Epoch	473	47.137771070004	
Epoch	474	47.279279768467	
Epoch	475	47.404191017151	
Epoch	476	46.97528809309	
Epoch	477	46.979295969009	
Epoch	478	47.310219824314	
Epoch	479	47.326141357422	
Epoch	480	46.754143118858	
Epoch	481	46.829235434532	
Epoch	482	46.852206528187	
Epoch	483	46.980171024799	
Epoch	484	47.572062671185	
Epoch	485	46.753736615181	
Epoch	486	46.697659790516	
Epoch	487	46.993619441986	
Epoch	488	46.934655070305	
Epoch	489	46.958256244659	
Epoch	490	47.255340278149	
Epoch	491	46.792699337006	
Epoch	492	46.512343943119	
Epoch	493	47.195642113686	
Epoch	494	46.463100910187	
Epoch	495	47.010799944401	
Epoch	496	46.072164356709	
Epoch	497	46.169371008873	
Epoch	498	45.990703463554	
Epoch	499	46.760864257812	
Epoch	500	46.945826947689	
Epoch	501	47.05782699585	
Epoch	502	46.837097764015	
Epoch	503	46.015219688416	
Epoch	504	45.91874653101	
Epoch	505	46.086439847946	
Epoch	506	47.273479640484	
Epoch	507	45.525038838387	
Epoch	508	46.384414672852	
Epoch	509	45.764182448387	
Epoch	510	45.897065341473	
Epoch	511	46.038526117802	
Epoch	512	46.084792852402	
Epoch	513	45.696182549	
Epoch	514	45.641432344913	
Epoch	515	46.1740000844	
Epoch	516	45.512035965919	
Epoch	517	45.775479733944	
Epoch	518	45.662252783775	
Epoch	519	45.682789444923	
Epoch	520	45.121926128864	
Epoch	521	45.207598030567	
Epoch	522	45.032652854919	
Epoch	523	45.791513979435	
Epoch	524	45.067572891712	
Epoch	525	45.525940477848	
Epoch	526	45.123126685619	
Epoch	527	46.141253888607	
Epoch	528	45.478736102581	
Epoch	529	44.858573675156	
Epoch	530	44.82212883234	
Epoch	531	45.093057692051	
Epoch	532	44.945489287376	
Epoch	533	45.428226709366	
Epoch	534	45.601362407207	
Epoch	535	45.374648809433	
Epoch	536	44.866034388542	
Epoch	537	44.817233145237	
Epoch	538	45.639934360981	
Epoch	539	44.969997823238	
Epoch	540	46.077632546425	
Epoch	541	44.77238047123	
Epoch	542	44.84618139267	
Epoch	543	44.909194052219	
Epoch	544	44.407470583916	
Epoch	545	44.47862046957	
Epoch	546	44.776267170906	
Epoch	547	44.976949989796	
Epoch	548	45.478788197041	
Epoch	549	44.908381819725	
Epoch	550	45.400710642338	
Epoch	551	44.794762134552	
Epoch	552	44.443011760712	
Epoch	553	44.495914101601	
Epoch	554	45.048239052296	
Epoch	555	45.33142131567	
Epoch	556	44.131946504116	
Epoch	557	44.894709467888	
Epoch	558	45.212786316872	
Epoch	559	44.041269302368	
Epoch	560	44.661124765873	
Epoch	561	44.362512588501	
Epoch	562	44.038657665253	
Epoch	563	44.726607203484	
Epoch	564	44.110574662685	
Epoch	565	44.44207072258	
Epoch	566	44.281942903996	
Epoch	567	44.828040659428	
Epoch	568	44.624581336975	
Epoch	569	43.107075691223	
Epoch	570	44.695241630077	
Epoch	571	44.153449952602	
Epoch	572	43.972323656082	
Epoch	573	43.676917076111	
Epoch	574	44.713617742062	
Epoch	575	44.054195761681	
Epoch	576	44.093990206718	
Epoch	577	44.213868677616	
Epoch	578	44.169532239437	
Epoch	579	44.148440778255	
Epoch	580	43.756552278996	
Epoch	581	43.876778662205	
Epoch	582	44.387538075447	
Epoch	583	43.397689163685	
Epoch	584	43.925974011421	
Epoch	585	44.190649271011	
Epoch	586	43.553596317768	
Epoch	587	44.031593441963	
Epoch	588	45.090789854527	
Epoch	589	43.354244112968	
Epoch	590	44.371935009956	
Epoch	591	43.346143841743	
Epoch	592	44.039302647114	
Epoch	593	43.483728706837	
Epoch	594	44.132868468761	
Epoch	595	44.113637506962	
Epoch	596	42.822784304619	
Epoch	597	43.125592172146	
Epoch	598	44.415808498859	
Epoch	599	43.539364159107	
Epoch	600	43.294128298759	
Starting the testing	
datafile:	/n/home09/ankitgupta/CS287/CS287assignments/finalproject/PRINC_CB513_1.hdf5	classifier:	rnn	b:	128	alpha:	1	sequence_length:	50	embedding_size	500	optimizer:	sgd	epochs:	600	hidden	200	eta:	0.01	rnn_unit1	lstm	rnn_unit2	lstm	dropout	0.5	
Accuracy	0.47350929814037	
